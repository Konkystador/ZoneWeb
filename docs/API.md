# üì° API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - –û–∫–æ–Ω–Ω—ã–µ –ú–∞—Å—Ç–µ—Ä–∞

## üîó –ë–∞–∑–æ–≤—ã–π URL

```
http://188.120.240.71/api
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ API endpoints (–∫—Ä–æ–º–µ `/login`) —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–µ—Å—Å–∏—é.

### –õ–æ–≥–∏–Ω
```http
POST /api/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "user": {
    "id": 1,
    "username": "admin",
    "role": "admin",
    "full_name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"
  }
}
```

### –í—ã—Ö–æ–¥
```http
POST /api/logout
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω"
}
```

## üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```http
GET /api/users
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "username": "admin",
    "role": "admin",
    "full_name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
    "is_active": 1,
    "created_at": "2024-10-17T18:00:00.000Z"
  }
]
```

### –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```http
POST /api/users
Content-Type: application/json

{
  "username": "newuser",
  "password": "password123",
  "role": "worker",
  "full_name": "–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
  "manager_id": 1
}
```

### –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```http
PUT /api/users/:id
Content-Type: application/json

{
  "full_name": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–º—è",
  "role": "manager"
}
```

### –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```http
DELETE /api/users/:id
```

## üìã –ó–∞–∫–∞–∑—ã

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã
```http
GET /api/orders
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `status` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
- `assigned_to` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
- `created_by` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "order_number": "ADM-000001",
    "client_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "client_phone": "+7-999-123-45-67",
    "client_telegram": "@ivan",
    "address": "–ú–æ—Å–∫–≤–∞, —É–ª. –¢–µ—Å—Ç–æ–≤–∞—è, 123",
    "city": "–ú–æ—Å–∫–≤–∞",
    "street": "—É–ª. –¢–µ—Å—Ç–æ–≤–∞—è",
    "house": "123",
    "entrance": "1",
    "floor": "5",
    "apartment": "50",
    "intercom": "1234",
    "problem_description": "–†–µ–º–æ–Ω—Ç –æ–∫–Ω–∞",
    "visit_date": "2024-10-20T10:00:00.000Z",
    "status": "pending",
    "assigned_to": 1,
    "created_by": 1,
    "created_at": "2024-10-17T18:00:00.000Z",
    "assigned_name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
    "created_by_name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"
  }
]
```

### –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑ –ø–æ ID
```http
GET /api/orders/:id
```

### –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
```http
POST /api/orders
Content-Type: application/json

{
  "client_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "client_phone": "+7-999-123-45-67",
  "client_telegram": "@ivan",
  "address": "–ú–æ—Å–∫–≤–∞, —É–ª. –¢–µ—Å—Ç–æ–≤–∞—è, 123",
  "city": "–ú–æ—Å–∫–≤–∞",
  "street": "—É–ª. –¢–µ—Å—Ç–æ–≤–∞—è",
  "house": "123",
  "entrance": "1",
  "floor": "5",
  "apartment": "50",
  "intercom": "1234",
  "problem_description": "–†–µ–º–æ–Ω—Ç –æ–∫–Ω–∞",
  "visit_date": "2024-10-20T10:00:00.000Z",
  "assigned_to": 1
}
```

### –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑
```http
PUT /api/orders/:id
Content-Type: application/json

{
  "status": "in_progress"
}
```

**–ò–ª–∏ –ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```json
{
  "client_name": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–º—è",
  "client_phone": "+7-999-999-99-99",
  "status": "completed"
}
```

### –£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑
```http
DELETE /api/orders/:id
```

### –ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤
```http
GET /api/orders/search?client_name=–ò–≤–∞–Ω&status=pending
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞:**
- `order_number` - –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
- `client_name` - –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞
- `client_phone` - —Ç–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞
- `address` - –∞–¥—Ä–µ—Å
- `status` - —Å—Ç–∞—Ç—É—Å
- `date_from` - –¥–∞—Ç–∞ –æ—Ç
- `date_to` - –¥–∞—Ç–∞ –¥–æ

## üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
```http
GET /api/user/profile
```

### –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
```http
PUT /api/user/profile
Content-Type: application/json

{
  "full_name": "–ü–æ–ª–Ω–æ–µ –∏–º—è",
  "phone1": "+7-999-123-45-67",
  "phone2": "+7-999-123-45-68",
  "phone3": "+7-999-123-45-69",
  "telegram": "@username",
  "whatsapp": "+7-999-123-45-67",
  "vk": "https://vk.com/username",
  "other_info": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
}
```

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
```http
PUT /api/user/password
Content-Type: application/json

{
  "current_password": "oldpassword",
  "new_password": "newpassword"
}
```

## üõ† –£—Å–ª—É–≥–∏ –∏ —Ü–µ–Ω—ã

### –ü–æ–ª—É—á–∏—Ç—å —É—Å–ª—É–≥–∏
```http
GET /api/services?category=repair
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥ (repair, mosquito, blinds)

### –°–æ–∑–¥–∞—Ç—å —É—Å–ª—É–≥—É
```http
POST /api/services
Content-Type: application/json

{
  "name": "–ó–∞–º–µ–Ω–∞ —É–ø–ª–æ—Ç–Ω–∏—Ç–µ–ª—è",
  "category": "repair",
  "calculation_type": "fixed_price",
  "base_price": 1500,
  "unit": "—à—Ç",
  "description": "–ó–∞–º–µ–Ω–∞ —É–ø–ª–æ—Ç–Ω–∏—Ç–µ–ª—è –Ω–∞ —Å—Ç–≤–æ—Ä–∫–µ"
}
```

### –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ —Å–∏—Å—Ç–µ–º
```http
GET /api/service-profiles?profile_type=plastic
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã

### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞–∫–∞–∑–æ–≤
```http
GET /api/orders/stats
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "total": 100,
  "pending": 15,
  "in_progress": 25,
  "completed": 50,
  "cancelled": 5,
  "declined": 5
}
```

## üîç –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–∞
```http
GET /api/orders/:id/history
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "order_id": 1,
    "user_id": 1,
    "action": "created",
    "action_text": "–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω",
    "changes": "–ù–æ–º–µ—Ä: ADM-000001, –ö–ª–∏–µ–Ω—Ç: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "created_at": "2024-10-17T18:00:00.000Z"
  }
]
```

## üìù –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| 200 | –£—Å–ø–µ—à–Ω–æ |
| 201 | –°–æ–∑–¥–∞–Ω–æ |
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å |
| 401 | –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω |
| 403 | –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω |
| 404 | –ù–µ –Ω–∞–π–¥–µ–Ω–æ |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

## ‚ö†Ô∏è –û—à–∏–±–∫–∏

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```json
{
  "error": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "details": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
}
```

## üîí –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤

### –°—Ç–∞—Ä—à–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã–º–∏
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

### –ú–µ–Ω–µ–¥–∂–µ—Ä
- –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤

### –†–∞–±–æ—Ç–Ω–∏–∫
- –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

## üì± –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript (Fetch API)
```javascript
// –õ–æ–≥–∏–Ω
const login = async (username, password) => {
  const response = await fetch('/api/login', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ username, password })
  });
  return response.json();
};

// –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã
const getOrders = async () => {
  const response = await fetch('/api/orders', {
    credentials: 'include'
  });
  return response.json();
};

// –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
const createOrder = async (orderData) => {
  const response = await fetch('/api/orders', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    credentials: 'include',
    body: JSON.stringify(orderData)
  });
  return response.json();
};
```

### cURL
```bash
# –õ–æ–≥–∏–Ω
curl -X POST http://188.120.240.71/api/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}' \
  -c cookies.txt

# –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã
curl -b cookies.txt http://188.120.240.71/api/orders

# –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
curl -X POST http://188.120.240.71/api/orders \
  -H "Content-Type: application/json" \
  -b cookies.txt \
  -d '{"client_name":"–¢–µ—Å—Ç","client_phone":"+7-999-123-45-67","address":"–¢–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å"}'
```

## üöÄ Rate Limiting

API –Ω–µ –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —á–∞—Å—Ç–æ—Ç–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å API:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º

---

**–í–µ—Ä—Å–∏—è API:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 17 –æ–∫—Ç—è–±—Ä—è 2024
